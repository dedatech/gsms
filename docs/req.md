# 项目需求文档

## 1. 项目概述
本项目旨在构建一个专注于研发团队使用的工时管理系统。核心目标是实现"员工填报便捷、管理统计清晰"，在保证核心体验流畅的前提下，摒弃复杂冗余的功能，打造一个"小而美"的轻量级工具。系统将重点解决两大问题：
1.  **便捷录入**：通过优化流程与交互，极大降低员工记录工时的操作成本，提升数据录入的意愿与及时性，确保数据源头质量。
2.  **多维洞察**：为项目经理与团队领导提供多维度、可视化的数据统计与分析功能，量化评估项目投入、团队产能与个人效能，为资源规划、项目复盘和效率提升提供数据支撑。

## 2. 功能需求
系统主要包含以下核心功能模块，各模块详细需求如下：

### 2.1 项目管理
- **功能描述**：
    1.  **项目基础操作**：支持项目的创建、编辑基本信息、归档（逻辑删除）及查询。项目是工时管理的顶层容器。
    2.  **项目成员与权限**：
        -   支持从组织架构中添加或移除项目成员。
        -   提供基于角色的项目级权限控制。预设"项目管理员"、"项目成员"、"只读访客"等角色，可精细化配置各角色对项目内任务、工时数据等的操作（查看、编辑、删除）和访问范围。
    3.  **项目概览仪表盘**：在项目主页集中展示关键健康度指标，帮助管理者快速掌握项目全貌。

- **项目核心属性**：
    - **基本信息**：项目ID（系统生成）、项目名称、项目标识（自定义编码）、项目负责人、 project描述。
    - **状态信息**：项目状态（未开始、进行中、已挂起、已归档）、计划开始/结束日期。
    - **动态信息**：项目成员列表、关联的迭代列表。
    - **统计信息**：项目总工时、任务总数及完成率（可配置在概览页）。

- **输入**：
    1.  创建/编辑项目表单（填写名称、标识、负责人、日期等）。
    2.  "添加成员"操作（选择用户并分配项目角色）。
    3.  项目权限配置操作（为各角色勾选权限项）。

- **输出**：
    1.  **项目列表页**：展示所有项目的卡片或列表，支持按状态、负责人筛选。
    2.  **项目详情页**：
        -   顶部显示项目基本信息。
        -   中部为数据概览（如工时消耗趋势图、任务状态分布饼图）。
        -   下部为成员列表、迭代列表等选项卡。
    3.  **项目设置页**：用于管理项目成员、配置角色权限的独立页面。

- **优先级**：高

### 2.2 任务管理（工作项分配）
- **功能描述**：
    1.  **工作项管理**：在项目内创建和管理具体的工作单元，是工时的直接关联对象。支持任务、需求、缺陷等多种类型。
    2.  **任务分配与跟踪**：将工作项指派给具体成员，并通过状态流转（如：待处理、进行中、已完成）跟踪其进度。提供看板视图，直观展示任务流程。
    3.  **工时关联**：任务属性包含"预估工时"，系统自动汇总成员在该任务上登记的"实际工时"，便于进行计划与实际对比。

- **任务核心属性**：
    - **标识信息**：任务标题、任务类型、优先级（高、中、低）、所属迭代/版本。
    - **执行信息**：负责人、状态、计划开始/完成日期。
    - **工时信息**：预估工时、已登记总工时（系统自动计算）。
    - **描述信息**：任务详情描述、备注、附件。

- **输入**：
    1.  创建/编辑任务表单（填写标题、类型、负责人、预估工时等）。
    2.  拖拽任务卡片以改变状态（在看板视图下）。
    3.  批量操作（批量分配负责人、修改状态）。

- **输出**：
    1.  **任务列表视图**：表格形式，展示所有任务的详细信息，支持排序和筛选。
    2.  **任务看板视图**：按状态分列，以卡片形式展示任务，支持拖拽。
    3.  **任务详情面板/页**：点击任务后，侧边滑出或跳转至详情页，展示完整属性、工时记录历史及评论。

- **优先级**：高

### 2.3 我的工时
- **功能描述**：为每个系统用户提供的个人工时管理核心门户，聚焦于便捷的记录与查看。
    1.  **工时填报**：
        -   **快速登记**：用户选择日期后，可快速为当天登记多条工时记录，每条记录需关联`项目 -> 任务`，并填写耗时与工作内容。
        -   **日历视图**：以周历或月历形式展示，直观查看每日工时分布，可直接在日历格点上点击添加。
    2.  **工时管理**：对已保存的工时记录进行修改、删除或提交审批（若启用审批流）。
    3.  **个人统计**：提供简单的个人工时汇总，如本周/本月总工时、各项目投入占比。

- **工时记录属性**：
    - 日期、所属项目、关联任务、工时数（支持0.5小时为最小单位）、工作内容描述、登记时间、状态（已保存/已提交/已确认）。

- **输入**：
    1.  在日历或列表视图中，点击"登记工时"按钮。
    2.  填写表单：选择项目（自动过滤出有权限的项目）、选择或搜索任务、填写工时数和工作内容。

- **输出**：
    1.  **我的工时首页**：集成日历视图、快速登记面板、近期工时列表。
    2.  **工时记录列表**：展示所有个人历史记录的表格，支持按日期、项目筛选。

- **优先级**：高

### 2.4 数据统计
- **功能描述**：系统的数据价值输出模块，提供多维度、可定制的分析报表。
    1.  **多维分析**：支持从`项目`、`部门/团队`、`个人`、`时间`（日/周/月/季/自定义）等多个维度进行交叉筛选与统计。
    2.  **丰富图表**：
        -   柱状图：用于对比不同项目、不同成员之间的工时投入。
        -   折线图：展示单个项目或团队工时随时间的变化趋势。
        -   饼图：展示工时在项目、任务类型或成员间的分布占比。
        -   表格：明细数据表，支持钻取查看。
    3.  **核心报表**：
        -   项目工时投入分析报告。
        -   团队/个人工作量饱和度与效能报告。
        -   计划工时 vs 实际工时对比分析报告。

- **输入**：
    1.  在统计页面，通过筛选器选择：时间范围、项目、部门、成员等分析维度。
    2.  选择想要查看的报表类型或图表类型。

- **输出**：
    1.  **动态图表**：根据筛选条件实时变化的可视化图表。
    2.  **数据表格**：图表对应的明细数据，支持分页、排序。
    3.  **导出文件**：一键将当前视图的图表和数据导出为 `PDF` 或 `Excel` 文件。

- **优先级**：中

### 2.5 系统设置
- **功能描述**：系统后台管理功能，确保系统有序运行。
    1.  **组织与用户管理**：
        -   维护公司组织架构（部门、小组树）。
        -   管理系统用户账号，支持启用/禁用、重置密码，并将用户分配至相应部门。
    2.  **全局权限管理**：
        -   基于统一的角色-权限模型（RBAC）定义系统级角色和权限点，权限配置不应写死在业务代码中。
        -   系统预置四类典型角色：系统管理员、业务经理、项目经理、员工，通过角色-权限配置实现不同的数据访问范围和操作能力。
        -   项目经理和员工的数据可见范围依赖项目成员关系，项目经理创建项目时默认自动加入该项目成员列表。
    3.  **基础数据字典**：统一维护系统使用的公共枚举值，如"任务类型"、"缺陷优先级"、"项目状态"等，确保数据规范性。
    4.  **操作日志**：记录关键操作的审计日志，如用户登录、数据删除、权限变更等，便于追踪与审计。

- **输入**：
    1.  在各类管理列表页进行增、删、改、查操作。
    2.  在角色权限配置页面，通过勾选方式配置权限点。

- **输出**：
    1.  各类管理功能的列表页与表单页（如用户列表、部门树、角色列表）。
    2.  操作日志查询页面，支持按操作人、时间、操作类型筛选。

- **优先级**：中

## 3. 技术要求
指定项目所需的技术栈，包括但不限于：
- 编程语言: 后端用java
- 框架：springboot、mybatis
- 数据库：mysql


## 4. 项目开发要求
必须按照下面要求顺序执行：
- **框架搭建：**
 1、框架要具备比较高的抽象，方便代码维护，比如：通用的常量类、枚举类、通用方法和工具、统一的请求和返回报文封装，统一的错误code定义，统一的身份校验解决方案，要采用token模式。
 2、先创建工程目录结构，预留数据库存放sql的资源文件夹。
 3、可以先写一个hello world 我审核。

- **需求分析：**

 1、阅读项目需求，并开展需求分析，如果有问题可以和我讨论。
 2、数据库设计，将数据库设计的ddl，放在项目工程的指定目录中，供我审核。
 3、 阐述你的需求分析思路，我审核后，开始编写代码，在编码前可以和我讨论。

- **全局技术与数据约定：**

 1、删除操作一律采用逻辑删除实现，所有核心业务实体（如项目、迭代、任务、工时、用户、部门等）均需通过统一的逻辑删除标记进行软删除，禁止直接物理删除，以保证历史数据可追溯与统计口径一致。
 2、权限设计必须基于统一的角色-权限模型（RBAC），通过角色-权限配置控制访问能力和数据范围，预置的系统管理员、业务经理、项目经理、员工等角色仅作为默认配置，不应在业务代码中写死逻辑。